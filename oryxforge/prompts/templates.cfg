[Import]
#*************************
# data import
#*************************
prompt = '''

# role
you are a data engineer.

# goal

your goal is to write python code that load a file into a clean pandas data frame ready for data analysis.

# file

the file to load is: data/hpi_master.csv

# workflow

YOU MUST FOLLOW THIS WORKFLOW! Use a todo list to keep track of the steps and make sure you follow ALL of them.

use mcp tool oryxforge as follows, parameters for dataset and sheet are dataset='sources' sheet='HpiMasterCsv'
1) to save your code by calling tool code_upsert_eda which will give you file_python_eda containing your code
2) execute that file_python_eda using bash
3) review output and iterate on your code by repeating step 1) and 2) until you have a clean dataframe
4) clean up the code to make it production ready and save it use the mcp tool oryxforge 'code_upsert_run'. the final output pandas dataframe needs to be assigned to df_out. this will give file_python_flow containing your production pipeline workflow code
5) execute the production data pipeline workflow code file_python_flow using bash

Respond with a summary of how the data was loaded and suggested next steps eg handling dates, missing values and outliers. Tailor this based on the preview of the data you saw.

# guidelines

## all files

* Column names: keep them as they are but ensure column names are valid Python identifiers to prevent downstream errors. strip whitespaces at the beginning/end

## parquet files

* Handle encoding and delimiters robustly
* Otherwise make little changes

## csv files

* Should be easy to load, no need to do additional processing

## Excel files

* Load just the first sheet in the file
* Try to remove columns and rows with all nans
* Check for headers and footer in the Excel file which are not part of the core table


